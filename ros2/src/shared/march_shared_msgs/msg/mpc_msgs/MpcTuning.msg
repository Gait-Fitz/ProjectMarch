float32[] q_weights
float32[] r_weights
int32 horizon