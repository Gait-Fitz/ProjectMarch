float32[] q_matrix
int32 horizon